# 라우터

## [DHCP](https://ko.wikipedia.org/wiki/동적_호스트_구성_프로토콜)
Dynamic Host Configuration Protocol<br>
공유기에서 클라이언트의 IP를 동적으로 구성하는 방법

### 동작 원리와 4개의 패킷

1. Discover
   * 컴퓨터가 IP 주소를 할당받고자 패킷을 네트워크상의 연결장치에 브로드캐스트 전송 (랜덤한 트랜잭션 아이디를 설정해서 보냄)

2. Offer
   * Discover를 받은 DHCP서버에서 클라이언트에게 Offer패킷으로 응답, Discover에서 받은 트랜잭션 아이디를 포함시켜 해당 요청의 응답임을 알려줌
   * DHCP 에서 설정된 대역주소 중 남은 IP주소와 함께 설정할 마스크, 게이트웨이, DNS서버의 IP주소, 임대 기간을 알려줌

3. Request
   * 브로드캐스트로 보냈기 때문에 여러개의 Offer 패킷을 받을 수 있음 따라서 그중 하나를 골라 Request 패킷을 전송한다.
   * 아직 IP주소가 설정되지 않았기 때문에 다시 브로드캐스트로 선택한 IP 주소를 최종적으로 공유기에 요청하는 패킷
  
4. Ack
   * 해당 주소를 사용해도 된다는 의미로 Ack 패킷을 전송하고 해당 주소를 다른 컴퓨터가 사용하지 못하도록 설정하고 Ack패킷을 받은 컴퓨터는 해당 IP주소, 마스크, 게이트웨이, DNS 서버 주소를 사용하게 된다.
  

### 주소 임대

DHCP는 Offer 패킷에서 알 수 있듯이 임대 기간을 가지고 있으며 얼마나 인터넷 접속이 필요할 것인지에 따라 달라질 수 있다.<br>
영구적인 IP 주소를 필요로 하는 웹 서버에 대해서는 정적인 주소를 제공한다.


## [NAT](https://ko.wikipedia.org/wiki/네트워크_주소_변환)

### NAT의 종류
network address tranlation
- SNAT : 미리 설정한 공인 IP주소를 할당하는 방식

- DNAT : 내부 내트워크의 각 기기가 외부 네트워크와 통신할 때 동적으로 공인IP를 할당하는 방식<br>
   사용가능한 IP를 할당받아 사용하다가 사용을 마치면 해당 IP주소를 반환하여 다른 기기가 다시 IP를 할당받을 수 있게 한다.

- PAT (prot address translation) : 내부 네트워크의 여러 기기가 하나의 공인IP를 사용하되 고유한 포트 번호를 할당받아 통신하는 방식<br>
   하나의 공인IP를사용하지만 포트번호를 통해 서로를 구분할 수 있다.<br>
   이 방식은 IP주소 부족 문제를 해결할 수 있을 뿐만 아니라 외부에서는 하나의 IP로 보이기 때문에 보안이 향상될 수 있다.


## [포트포워딩](https://ko.wikipedia.org/wiki/포트_포워딩)

외부에서 사설 IP 주소를 사용하는 서버 컴퓨터로 접속 할 수 있게 해주는 설정
라우터에 포트 포워딩을 해두면 라우터에서 패킷을 받았을 때 해당 컴퓨터로 패킷을 보낸다.